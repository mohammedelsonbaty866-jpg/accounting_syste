<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
--main:#1f2937;
--accent:#0ea5e9;
--danger:#ef4444;
--bg:#f3f4f6;
--card:#ffffff;
}

body{
margin:0;
font-family:Tahoma,Arial;
direction:rtl;
background:var(--bg);
}

header{
background:var(--main);
color:#fff;
padding:15px;
text-align:center;
}

nav{
display:flex;
background:#fff;
border-bottom:1px solid #ddd;
}
nav button{
flex:1;
padding:12px;
border:none;
background:none;
font-size:14px;
}
nav button:hover{
background:var(--bg);
}

.container{padding:12px}

.card{
background:var(--card);
padding:12px;
margin-bottom:12px;
border-radius:8px;
box-shadow:0 2px 6px rgba(0,0,0,.1);
}

input,select{
width:100%;
padding:10px;
margin:6px 0;
border-radius:6px;
border:1px solid #ccc;
}

button{
padding:12px;
border:none;
border-radius:6px;
font-size:14px;
cursor:pointer;
width:100%;
margin-top:6px;
}

.btn-main{background:var(--accent);color:#fff}
.btn-danger{background:var(--danger);color:#fff}
.btn-dark{background:var(--main);color:#fff}

.hidden{display:none}

/* ÙØ§ØªÙˆØ±Ø© Ø­Ø±Ø§Ø±ÙŠØ© */
#printArea{
width:80mm;
font-size:12px;
}
@media print{
body *{visibility:hidden}
#printArea, #printArea *{visibility:visible}
#printArea{position:absolute;top:0;right:0}
}
</style>
</head>

<body>

<header>
<h3 id="shopName">Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„</h3>
<small id="shopLogo">ğŸ§¾</small>
</header>

<nav>
<button onclick="show('invoice')">ÙØ§ØªÙˆØ±Ø©</button>
<button onclick="show('partners')">Ø¹Ù…Ù„Ø§Ø¡</button>
<button onclick="show('report')">Ø¨Ø­Ø«</button>
<button onclick="show('settings')">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
</nav>

<div class="container">

<!-- ÙØ§ØªÙˆØ±Ø© -->
<div id="invoice" class="card">
<b>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: <span id="invoiceNo"></span></b>

<select id="partner"></select>
<input id="desc" placeholder="Ø§Ù„ÙˆØµÙ">
<input id="amount" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">

<input id="tax" type="number" placeholder="Ø¶Ø±ÙŠØ¨Ø© %">
<input id="discount" type="number" placeholder="Ø®ØµÙ…">

<select id="type">
<option value="income">Ø¨ÙŠØ¹</option>
<option value="expense">Ø´Ø±Ø§Ø¡</option>
</select>

<button class="btn-main" onclick="addInvoice()">Ø­ÙØ¸</button>
<button class="btn-dark" onclick="printInvoice()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

<!-- Ø¹Ù…Ù„Ø§Ø¡ -->
<div id="partners" class="card hidden">
<input id="partnerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<button class="btn-main" onclick="addPartner()">Ø¥Ø¶Ø§ÙØ©</button>
<ul id="partnerList"></ul>
</div>

<!-- Ø¨Ø­Ø« -->
<div id="report" class="card hidden">
<input id="search" placeholder="Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø£Ùˆ Ø§Ù„Ø§Ø³Ù…" oninput="renderSearch()">
<div id="searchResult"></div>
</div>

<!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
<div id="settings" class="card hidden">
<input id="shopNameInput" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„">
<input id="shopLogoInput" placeholder="Ø´Ø¹Ø§Ø± (Ù…Ø«Ø§Ù„ ğŸ§¾)">
<button class="btn-main" onclick="saveSettings()">Ø­ÙØ¸</button>
</div>

</div>

<!-- Ø·Ø¨Ø§Ø¹Ø© -->
<div id="printArea" class="hidden">
<h3 id="pShop"></h3>
<div id="printContent"></div>
<p style="text-align:center">Ø´ÙƒØ±Ø§Ù‹ Ù„Ø²ÙŠØ§Ø±ØªÙƒÙ…</p>
</div>

<script>
let partners=JSON.parse(localStorage.getItem("partners"))||[];
let invoices=JSON.parse(localStorage.getItem("invoices"))||[];
let counter=Number(localStorage.getItem("counter"))||1;

invoiceNo.innerText=counter;

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
shopName.innerText=localStorage.getItem("shopName")||"Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„";
shopLogo.innerText=localStorage.getItem("shopLogo")||"ğŸ§¾";

function show(id){
["invoice","partners","report","settings"].forEach(x=>{
document.getElementById(x).classList.add("hidden");
});
document.getElementById(id).classList.remove("hidden");
}

function save(){
localStorage.setItem("partners",JSON.stringify(partners));
localStorage.setItem("invoices",JSON.stringify(invoices));
localStorage.setItem("counter",counter);
}

function addPartner(){
if(partnerName.value){
partners.push(partnerName.value);
partnerName.value="";
save();
renderPartners();
}
}

function renderPartners(){
partner.innerHTML="";
partnerList.innerHTML="";
partners.forEach(p=>{
partner.innerHTML+=`<option>${p}</option>`;
partnerList.innerHTML+=`<li>${p}</li>`;
});
}

function addInvoice(){
let a=+amount.value;
let taxv=+tax.value||0;
let disc=+discount.value||0;
let total=a + (a*taxv/100) - disc;

invoices.push({
no:counter,
p:partner.value,
d:desc.value,
a,total,tax:taxv,disc,
t:type.value,
date:new Date().toLocaleString()
});
counter++;
save();
invoiceNo.innerText=counter;
alert("ØªÙ… Ø§Ù„Ø­ÙØ¸");
}

function renderSearch(){
let q=search.value;
searchResult.innerHTML="";
invoices.filter(i=>
i.no==q || i.p.includes(q)
).forEach(i=>{
searchResult.innerHTML+=`
<div class="card">
ÙØ§ØªÙˆØ±Ø© #${i.no}<br>
${i.p}<br>
Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${i.total}
</div>`;
});
}

function saveSettings(){
localStorage.setItem("shopName",shopNameInput.value);
localStorage.setItem("shopLogo",shopLogoInput.value);
shopName.innerText=shopNameInput.value;
shopLogo.innerText=shopLogoInput.value;
alert("ØªÙ… Ø§Ù„Ø­ÙØ¸");
}

function printInvoice(){
let i=invoices[invoices.length-1];
pShop.innerText=shopName.innerText;
printContent.innerHTML=`
ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù…: ${i.no}<br>
Ø§Ù„Ø¹Ù…ÙŠÙ„: ${i.p}<br>
Ø§Ù„ÙˆØµÙ: ${i.d}<br>
Ø§Ù„Ù…Ø¨Ù„Øº: ${i.a}<br>
Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: ${i.tax}%<br>
Ø§Ù„Ø®ØµÙ…: ${i.disc}<br>
<b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${i.total}</b><br>
${i.date}
`;
printArea.classList.remove("hidden");
window.print();
printArea.classList.add("hidden");
}

renderPartners();
</script>

</body>
</html>
