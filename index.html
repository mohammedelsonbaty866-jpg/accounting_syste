<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…Ø­Ø§Ø³Ø¨ÙŠ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
font-family:Tahoma,Arial;
direction:rtl;
margin:0;
background:#f4f4f4
}
header{
background:#000;
color:#fff;
padding:10px;
text-align:center
}
nav button{
width:33%;
padding:10px;
border:none;
background:#eee
}
.container{padding:10px}
.card{
background:#fff;
padding:10px;
margin-bottom:10px;
border-radius:5px
}
input,select,button{
width:100%;
padding:10px;
margin:5px 0
}
button{background:#000;color:#fff;border:none}
.hidden{display:none}
table{width:100%;border-collapse:collapse}
th,td{border-bottom:1px solid #ddd;padding:5px;text-align:center}

/* ===== ÙØ§ØªÙˆØ±Ø© Ø­Ø±Ø§Ø±ÙŠØ© ===== */
#printArea{
width:80mm;
background:#fff;
color:#000;
font-size:12px;
padding:5px
}
#printArea h3{
text-align:center;
margin:5px 0
}
@media print{
body *{visibility:hidden}
#printArea, #printArea *{
visibility:visible
}
#printArea{
position:absolute;
top:0;
right:0
}
}
</style>
</head>

<body>

<header>ğŸ§¾ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…Ø­Ø§Ø³Ø¨ÙŠ + ÙÙˆØ§ØªÙŠØ±</header>

<nav>
<button onclick="show('invoice')">ÙØ§ØªÙˆØ±Ø©</button>
<button onclick="show('partners')">Ø¹Ù…Ù„Ø§Ø¡ / Ù…ÙˆØ±Ø¯ÙŠÙ†</button>
<button onclick="show('report')">ØªÙ‚Ø±ÙŠØ±</button>
</nav>

<div class="container">

<!-- ===== Ø§Ù„ÙØ§ØªÙˆØ±Ø© ===== -->
<div id="invoice" class="card">
<select id="partner"></select>

<input id="desc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©">
<input id="amount" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">

<select id="type">
<option value="income">Ø¥ÙŠØ±Ø§Ø¯</option>
<option value="expense">Ù…ØµØ±ÙˆÙ</option>
</select>

<button onclick="addInvoice()">Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
<button onclick="printInvoice()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø© Ø­Ø±Ø§Ø±ÙŠØ©</button>
</div>

<!-- ===== Ø¹Ù…Ù„Ø§Ø¡ / Ù…ÙˆØ±Ø¯ÙŠÙ† ===== -->
<div id="partners" class="card hidden">
<input id="partnerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ / Ø§Ù„Ù…ÙˆØ±Ø¯">
<button onclick="addPartner()">Ø¥Ø¶Ø§ÙØ©</button>

<ul id="partnerList"></ul>
</div>

<!-- ===== Ø§Ù„ØªÙ‚Ø±ÙŠØ± ===== -->
<div id="report" class="card hidden">
<div id="summary"></div>
</div>

</div>

<!-- ===== Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© ===== -->
<div id="printArea" class="hidden">
<h3>ÙØ§ØªÙˆØ±Ø©</h3>
<div id="printContent"></div>
<p style="text-align:center">Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</p>
</div>

<script>
let partners = JSON.parse(localStorage.getItem("partners")) || [];
let invoices = JSON.parse(localStorage.getItem("invoices")) || [];

function show(id){
["invoice","partners","report"].forEach(x=>{
document.getElementById(x).classList.add("hidden");
});
document.getElementById(id).classList.remove("hidden");
}

function save(){
localStorage.setItem("partners",JSON.stringify(partners));
localStorage.setItem("invoices",JSON.stringify(invoices));
}

function renderPartners(){
let s=document.getElementById("partner");
let ul=document.getElementById("partnerList");
s.innerHTML="";
ul.innerHTML="";
partners.forEach(p=>{
s.innerHTML+=`<option>${p}</option>`;
ul.innerHTML+=`<li>${p}</li>`;
});
}

function addPartner(){
let n=partnerName.value;
if(n){
partners.push(n);
partnerName.value="";
save();
renderPartners();
}
}

function addInvoice(){
let p=partner.value;
let d=desc.value;
let a=amount.value;
let t=type.value;
if(p&&a){
invoices.push({p,d,a,t,date:new Date().toLocaleString()});
save();
alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©");
desc.value=amount.value="";
renderReport();
}
}

function renderReport(){
let inc=0,exp=0;
invoices.forEach(i=>{
i.t==="income"?inc+=+i.a:exp+=+i.a;
});
summary.innerHTML=`
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${inc}<br>
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª: ${exp}<br>
Ø§Ù„ØµØ§ÙÙŠ: ${inc-exp}
`;
}

function printInvoice(){
let last=invoices[invoices.length-1];
if(!last){alert("Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ§ØªÙˆØ±Ø©");return;}
printContent.innerHTML=`
Ø§Ù„Ø¹Ù…ÙŠÙ„/Ø§Ù„Ù…ÙˆØ±Ø¯: ${last.p}<br>
Ø§Ù„ÙˆØµÙ: ${last.d}<br>
Ø§Ù„Ù…Ø¨Ù„Øº: ${last.a}<br>
Ø§Ù„Ù†ÙˆØ¹: ${last.t==="income"?"Ø¥ÙŠØ±Ø§Ø¯":"Ù…ØµØ±ÙˆÙ"}<br>
Ø§Ù„ØªØ§Ø±ÙŠØ®: ${last.date}
`;
printArea.classList.remove("hidden");
window.print();
printArea.classList.add("hidden");
}

renderPartners();
renderReport();
</script>

</body>
</html>
