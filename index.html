<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨ÙŠ ØªØ¬Ø§Ø±ÙŠ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
--main:#0f172a;
--accent:#2563eb;
--success:#22c55e;
--danger:#ef4444;
--bg:#f1f5f9;
--card:#ffffff;
}

body{
margin:0;
font-family:Tahoma,Arial;
direction:rtl;
background:var(--bg);
}

header{
background:linear-gradient(90deg,#0f172a,#1e293b);
color:#fff;
padding:15px;
text-align:center;
}

nav{
display:flex;
background:#fff;
border-bottom:1px solid #ddd;
}
nav button{
flex:1;
padding:12px;
border:none;
background:none;
font-size:14px;
}
nav button:hover{background:#f1f5f9}

.container{padding:12px}

.card{
background:var(--card);
padding:14px;
margin-bottom:12px;
border-radius:10px;
box-shadow:0 4px 10px rgba(0,0,0,.08);
}

input,select{
width:100%;
padding:10px;
margin:6px 0;
border-radius:6px;
border:1px solid #ccc;
}

button{
width:100%;
padding:12px;
margin-top:6px;
border:none;
border-radius:6px;
font-size:14px;
cursor:pointer;
}

.btn-main{background:var(--accent);color:#fff}
.btn-success{background:var(--success);color:#fff}
.btn-danger{background:var(--danger);color:#fff}

.hidden{display:none}

/* Ø·Ø¨Ø§Ø¹Ø© Ø­Ø±Ø§Ø±ÙŠØ© */
#printArea{width:80mm;font-size:12px}
@media print{
body *{visibility:hidden}
#printArea, #printArea *{visibility:visible}
#printArea{position:absolute;top:0;right:0}
}
</style>
</head>

<body>

<!-- ===== ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ===== -->
<div id="login" class="container">
<div class="card">
<h3>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
<input id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="loginPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button class="btn-main" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>
</div>

<!-- ===== Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ===== -->
<div id="app" class="hidden">

<header>
<h3>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨ÙŠ ØªØ¬Ø§Ø±ÙŠ</h3>
<small id="currentUser"></small>
</header>

<nav>
<button onclick="show('dashboard')">ğŸ“Š</button>
<button onclick="show('invoice')">ğŸ§¾</button>
<button onclick="show('products')">ğŸ“¦</button>
<button onclick="show('users')">ğŸ‘¤</button>
<button onclick="logout()">ğŸšª</button>
</nav>

<div class="container">

<!-- ===== Dashboard ===== -->
<div id="dashboard" class="card">
<h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
<div id="stats"></div>
</div>

<!-- ===== ÙØ§ØªÙˆØ±Ø© ===== -->
<div id="invoice" class="card hidden">
<b>ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</b>

<select id="productSelect"></select>
<input id="qty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" value="1">

<button class="btn-success" onclick="addItem()">Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙØ§ØªÙˆØ±Ø©</button>

<hr>
<div id="invoiceItems"></div>
<b id="invoiceTotal">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0</b>

<button class="btn-main" onclick="saveInvoice()">Ø­ÙØ¸</button>
<button class="btn-success" onclick="printInvoice()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

<!-- ===== Ø£ØµÙ†Ø§Ù ===== -->
<div id="products" class="card hidden">
<h3>ğŸ“¦ Ø§Ù„Ø£ØµÙ†Ø§Ù</h3>
<input id="productName" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
<input id="productPrice" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<button class="btn-main" onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
<ul id="productList"></ul>
</div>

<!-- ===== Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ===== -->
<div id="users" class="card hidden">
<h3>ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
<input id="newUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="newPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button class="btn-main" onclick="addUser()">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</button>
<ul id="userList"></ul>
</div>

</div>
</div>

<!-- ===== Ø·Ø¨Ø§Ø¹Ø© ===== -->
<div id="printArea" class="hidden">
<h3>ÙØ§ØªÙˆØ±Ø©</h3>
<div id="printContent"></div>
<p style="text-align:center">Ø´ÙƒØ±Ø§Ù‹ Ù„Ø²ÙŠØ§Ø±ØªÙƒÙ…</p>
</div>

<script>
/* ===== Ø¨ÙŠØ§Ù†Ø§Øª ===== */
let users = JSON.parse(localStorage.getItem("users")) || [
{u:"admin",p:"1234"}
];
let products = JSON.parse(localStorage.getItem("products")) || [];
let invoices = JSON.parse(localStorage.getItem("invoices")) || [];
let cart = [];
let loggedUser = localStorage.getItem("loggedUser");

/* ===== Ø¯Ø®ÙˆÙ„ ===== */
function login(){
let u=loginUser.value,p=loginPass.value;
let ok=users.find(x=>x.u===u && x.p===p);
if(ok){
localStorage.setItem("loggedUser",u);
showApp();
}else alert("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
}

function showApp(){
login.classList.add("hidden");
app.classList.remove("hidden");
currentUser.innerText="Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: "+localStorage.getItem("loggedUser");
renderAll();
}

if(loggedUser) showApp();

/* ===== Ø®Ø±ÙˆØ¬ ===== */
function logout(){
localStorage.removeItem("loggedUser");
location.reload();
}

/* ===== ØªÙ†Ù‚Ù„ ===== */
function show(id){
["dashboard","invoice","products","users"].forEach(x=>{
document.getElementById(x).classList.add("hidden");
});
document.getElementById(id).classList.remove("hidden");
}

/* ===== Ø£ØµÙ†Ø§Ù ===== */
function addProduct(){
if(productName.value && productPrice.value){
products.push({n:productName.value,p:+productPrice.value});
productName.value=productPrice.value="";
save();
renderProducts();
}
}

function renderProducts(){
productSelect.innerHTML="";
productList.innerHTML="";
products.forEach((p,i)=>{
productSelect.innerHTML+=`<option value="${i}">${p.n} - ${p.p}</option>`;
productList.innerHTML+=`<li>${p.n} - ${p.p}</li>`;
});
}

/* ===== ÙØ§ØªÙˆØ±Ø© ===== */
function addItem(){
let p=products[productSelect.value];
let q=+qty.value;
cart.push({n:p.n,p:p.p,q});
renderCart();
}

function renderCart(){
let t=0;
invoiceItems.innerHTML="";
cart.forEach(i=>{
let s=i.p*i.q;
t+=s;
invoiceItems.innerHTML+=`${i.n} x${i.q} = ${s}<br>`;
});
invoiceTotal.innerText="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: "+t;
}

function saveInvoice(){
invoices.push({user:loggedUser,items:cart,date:new Date().toLocaleString()});
cart=[];
save();
renderCart();
renderStats();
alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©");
}

/* ===== Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ===== */
function addUser(){
if(newUser.value && newPass.value){
users.push({u:newUser.value,p:newPass.value});
newUser.value=newPass.value="";
save();
renderUsers();
}
}

function renderUsers(){
userList.innerHTML="";
users.forEach(u=>{
userList.innerHTML+=`<li>${u.u}</li>`;
});
}

/* ===== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===== */
function renderStats(){
stats.innerHTML=`
Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±: ${invoices.length}<br>
Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù: ${products.length}<br>
Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: ${users.length}
`;
}

/* ===== Ø·Ø¨Ø§Ø¹Ø© ===== */
function printInvoice(){
let last=invoices[invoices.length-1];
let html="";
last.items.forEach(i=>{
html+=`${i.n} x${i.q} = ${i.p*i.q}<br>`;
});
printContent.innerHTML=html;
printArea.classList.remove("hidden");
window.print();
printArea.classList.add("hidden");
}

/* ===== Ø­ÙØ¸ ===== */
function save(){
localStorage.setItem("users",JSON.stringify(users));
localStorage.setItem("products",JSON.stringify(products));
localStorage.setItem("invoices",JSON.stringify(invoices));
}

/* ===== ØªØ´ØºÙŠÙ„ ===== */
function renderAll(){
renderProducts();
renderUsers();
renderStats();
}
</script>

</body>
</html>
